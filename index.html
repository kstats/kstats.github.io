<!DOCTYPE HTML>  
<html>  
    <header>
        <link rel="stylesheet" href="style.css">
    </header>
    <body>  
        <h1>Berkeley Restaurants</h1>

        <div id="showDataJSON"></div>
        <br/>
        <div id="showDataXML"></div>
    </body>

    <script>

        /*
         * JSON
         * - Get JSON data from file
         * - Get headers from retrieved data
         * - Set headers for table
         * - Add data to table
         * - Add table to DOM
        */

        let jsonData;
        let xhrJson = new XMLHttpRequest();
        xhrJson.open('GET', './data.json', false); 
        xhrJson.send();
        if(xhrJson.status == 200) { 
            jsonData = JSON.parse(xhrJson.responseText);
        }

        var jsonHeaders = [];
        let restaurant = jsonData.restaurants[0];
        for (let key in restaurant) {
            jsonHeaders.push(key);
        }

        var jsonTable = document.createElement("table");

        var tr = jsonTable.insertRow(-1);                 
        for (let key in jsonHeaders) {
            var th = document.createElement("th");      
            th.innerHTML = jsonHeaders[key];
            tr.appendChild(th);
        }

        for (let key in jsonData.restaurants) {
            tr = jsonTable.insertRow(-1);
            let restaurant = jsonData.restaurants[key];
            for (let rest_key in restaurant) {
                var tabCell = tr.insertCell(-1);
                tabCell.innerHTML = restaurant[rest_key];
            }
        }

        var divContainer = document.getElementById("showDataJSON");
        divContainer.innerHTML = "";
        divContainer.appendChild(jsonTable);

        /*
         * XML
         * - Get XML data from file
         * - Get headers from retrieved data
         * - Set headers for table
         * - Add data to table
         * - Add table to DOM
        */

        let xmlFile = new XMLHttpRequest();
        xmlFile.open("GET", "./data.xml", false);
        xmlFile.send();
        let xmlData = xmlFile.responseXML;

        let xmlRestaurants = xmlData.getElementsByTagName("restaurant")
        let xmlHeaders = [];
        for (let j = 0; j < xmlRestaurants[0].childNodes.length; j++) {
            //makes sure this isn't a text node, which is just whitespace
            if(xmlRestaurants[0].childNodes[j].nodeType !== 3){
                xmlHeaders.push(xmlRestaurants[0].childNodes[j].nodeName);
            }
        }

        var xmlTable = document.createElement("table");

        var tr = xmlTable.insertRow(-1);      
        for (let key in xmlHeaders) {
            var th = document.createElement("th");      
            th.innerHTML = xmlHeaders[key];
            tr.appendChild(th);
        }
        
        for (var i = 0; i < xmlRestaurants.length; i++) {
            tr = xmlTable.insertRow(-1);
            for (var j = 0; j < xmlRestaurants[i].childNodes.length; j++) {
                if (xmlRestaurants[i].childNodes[j].nodeType !== 3){
                    var tabCell = tr.insertCell(-1);
                    tabCell.innerHTML = xmlRestaurants[i].childNodes[j].textContent;
                }
                
            }
        }

        var divContainer2 = document.getElementById("showDataXML");
        divContainer2.innerHTML = "";
        divContainer2.appendChild(xmlTable);

    </script>  
</html>